SELECT NULL SEGMENT_NAME, NULL NUM_ROWS, NULL BLKS, 
NULL DIST_KEYS, NULL CLST_FACT, NULL B_LVL, NULL COMP, NULL "COLUMN_NAME(NDV)" FROM DUAL WHERE 1=0
UNION ALL
(
SELECT NULL SEGMENT_NAME, NULL NUM_ROWS, NULL BLKS, 
NULL DIST_KEYS, NULL CLST_FACT, NULL B_LVL, NULL COMP, NULL "COLUMN_NAME(NDV)" FROM DUAL WHERE 1=0
)
UNION ALL
SELECT * FROM (
WITH BASIS_INFO AS
(
SELECT
	'SAP%' OWNER,
	'T100' TABLE_NAME
FROM
	DUAL
)
SELECT *
FROM
(
SELECT
	DT.TABLE_NAME SEGMENT_NAME,
	TO_CHAR(DT.NUM_ROWS,'999999999999') NUM_ROWS,
	TO_CHAR(DT.BLOCKS,'999999999999') BLKS,
	'' DIST_KEYS,
	'' CLST_FACT,
	'' B_LVL,
	NVL(COMPRESS_FOR,'NO') COMP,
	'' "COLUMN_NAME(NDV)"
FROM
	DBA_TABLES DT,
	BASIS_INFO BI
WHERE
	DT.TABLE_NAME = BI.TABLE_NAME AND
	DT.OWNER LIKE BI.OWNER
UNION ALL
SELECT 
	DIC.INDEX_NAME SEGMENT_NAME,
	TO_CHAR(MAX(DI.NUM_ROWS),'999999999999') NUM_ROWS,
	TO_CHAR(MAX(DI.LEAF_BLOCKS),'999999999999') BLKS,
	TO_CHAR(MAX(DI.DISTINCT_KEYS),'999999999999') DIST_KEYS,
	TO_CHAR(MAX(DI.CLUSTERING_FACTOR),'999999999999') CLST_FACT,
	TO_CHAR(MAX(DI.BLEVEL),'99') B_LVL,
	MAX(DECODE(DI.COMPRESSION,'ENABLED','YES('||DI.PREFIX_LENGTH||')','NO')) COMP,
	LISTAGG(DIC.COLUMN_NAME||'('||DTC.NUM_DISTINCT||')',',')
		WITHIN GROUP(ORDER BY DIC.COLUMN_POSITION) "COLUMN_NAME(NDV)"
FROM
	DBA_IND_COLUMNS DIC, 
	DBA_TAB_COLUMNS DTC,
	DBA_INDEXES DI,
	BASIS_INFO BI
WHERE
	DI.TABLE_NAME = DIC.TABLE_NAME AND
	DI.INDEX_NAME = DIC.INDEX_NAME AND
	DIC.TABLE_NAME = DTC.TABLE_NAME AND
	DIC.COLUMN_NAME = DTC.COLUMN_NAME AND
	DIC.TABLE_NAME = BI.TABLE_NAME AND
	DI.OWNER LIKE BI.OWNER AND
	DI.OWNER = DTC.OWNER AND
	DI.OWNER = DIC.TABLE_OWNER	
GROUP BY
	DIC.INDEX_NAME
)
ORDER BY
	SEGMENT_NAME
)