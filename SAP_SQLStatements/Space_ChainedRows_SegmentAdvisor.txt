SELECT NULL ANALYSIS_TIME, NULL TABLE_NAME, NULL PARTITION_NAME,
  NULL CHAIN_PCT, NULL CHAINED_ROWS FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL ANALYSIS_TIME, NULL TABLE_NAME, NULL PARTITION_NAME,
  NULL CHAIN_PCT, NULL CHAINED_ROWS FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    TO_DATE('01.01.1000 18:00:00', 'dd.mm.yyyy hh24:mi:ss') MIN_ANALYSIS_TIME
  FROM
    DUAL
)
SELECT
  TO_CHAR(ANALYSIS_TIME, 'dd.mm.yyyy hh24:mi:ss') ANALYSIS_TIME,
  TABLE_NAME,
  PARTITION_NAME,
  TO_CHAR(CHAIN_PCT, 99990.99) CHAIN_PCT,
  TO_CHAR(CHAIN_PCT / 100 * NUM_ROWS, 99999999990) CHAINED_ROWS
FROM
( SELECT
    ANALYSIS_TIME,
    OWNER,
    TABLE_NAME,
    PARTITION_NAME,
    SEGMENT_TYPE,
    MESSAGE,
    MORE_INFO,
    REGEXP_REPLACE(MORE_INFO, '([0-9]+) percent chained.*', 
      '\1', 1, 1, 'i') CHAIN_PCT,
    NUM_ROWS
  FROM
  ( SELECT
      DAT.EXECUTION_START ANALYSIS_TIME,
      DAO.ATTR1 OWNER,
      DAO.ATTR2 TABLE_NAME,
      DAO.ATTR3 PARTITION_NAME,
      DAO.TYPE SEGMENT_TYPE,
      DAF.MESSAGE MESSAGE,
      DAF.MORE_INFO,
      NVL(DTS.NUM_ROWS, 0) NUM_ROWS,
      ROW_NUMBER () OVER (PARTITION BY DAO.ATTR1, DAO.ATTR2, DAO.ATTR3 
        ORDER BY DAT.EXECUTION_END DESC) ROW_NUMBER
    FROM
      BASIS_INFO BI,
      DBA_ADVISOR_TASKS DAT,
      DBA_ADVISOR_FINDINGS DAF,
      DBA_ADVISOR_OBJECTS DAO,
      DBA_TAB_STATISTICS DTS
    WHERE
      DAT.EXECUTION_START >= BI.MIN_ANALYSIS_TIME AND
      DAT.OWNER = DAF.OWNER AND
      DAT.TASK_ID = DAF.TASK_ID AND
      DAF.TASK_ID = DAO.TASK_ID AND
      DAF.OBJECT_ID = DAO.OBJECT_ID AND 
      DAO.ATTR1 = DTS.OWNER AND
      DAO.ATTR2 = DTS.TABLE_NAME AND
      NVL(DAO.ATTR3, ' ') = NVL(DTS.PARTITION_NAME, ' ') AND
      DAT.ADVISOR_NAME = 'Segment Advisor' AND
      DAF.MORE_INFO LIKE '%chained rows%'
    ORDER BY
      DAT.EXECUTION_END DESC
  ) 
  WHERE
    ROW_NUMBER = 1
)
ORDER BY
  CHAINED_ROWS DESC
));