SELECT NULL OWNER, NULL INDEX_NAME, NULL DISTINCT_KEYS FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL INDEX_NAME, NULL DISTINCT_KEYS FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    1000000 DISTINCT_KEYS_THRESHOLD,
    ' ' EXCLUDE_BW_INDEXES
  FROM
    DUAL
)
SELECT
  DI.OWNER,
  DI.INDEX_NAME,
  TO_CHAR(DI.DISTINCT_KEYS, 999999999990) DISTINCT_KEYS
FROM
  BASIS_INFO BI,
  DBA_INDEXES DI
WHERE
  DI.OWNER LIKE BI.OWNER AND
  ( DI.DISTINCT_KEYS IS NULL OR DI.DISTINCT_KEYS >= BI.DISTINCT_KEYS_THRESHOLD ) AND
  ( BI.EXCLUDE_BW_INDEXES = ' ' OR DI.INDEX_NAME NOT LIKE '/BI_/%' ) AND
  DI.INDEX_TYPE = 'BITMAP'
ORDER BY
  DI.DISTINCT_KEYS DESC
));

