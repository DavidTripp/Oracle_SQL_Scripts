SELECT NULL OWNER, NULL TABLE_NAME FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    'X' ONLY_NONDEFAULT_HISTGRM_TABLES
  FROM
    DUAL
)
SELECT DISTINCT
  TC.OWNER,
  TC.TABLE_NAME
FROM
  BASIS_INFO BI,
  DBA_TAB_COLUMNS TC
WHERE
  TC.OWNER LIKE BI.OWNER AND
  ( BI.ONLY_NONDEFAULT_HISTGRM_TABLES = ' ' OR
    ( TC.TABLE_NAME NOT LIKE '/BI%' AND 
      TC.TABLE_NAME NOT LIKE '/B20%' AND
      TC.TABLE_NAME NOT IN 
      ( 'BDCP', 'BDCPS', 
        'COSS', 'COSP',
        'LTAP', 'LTBP', 
        'MSEG', 'MKPF', 
        'RSDD_TMPNM_ADM',
        'PPC_HEAD',
        'RSREQDONE', 'RSSELDONE', 'RSSTATMANREQMAP',
          'RSSTATMANSTATUS', 'RSTSODSREQUEST' )
    ) 
  ) AND
  TC.HISTOGRAM != 'NONE'
));
