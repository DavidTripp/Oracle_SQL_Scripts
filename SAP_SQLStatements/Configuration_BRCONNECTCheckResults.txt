SELECT NULL MSG_DATE, NULL NAME, NULL BRCONNECT_CODE, NULL MSG_TEXT FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL MSG_DATE, NULL NAME, NULL BRCONNECT_CODE, NULL MSG_TEXT FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    SYSDATE - 7 BEGIN_DATE,
    SYSDATE END_DATE,
    '%' NAME_PATTERN,
    '%' MSG_PATTERN,
    '%' SEVERITY,           /* WARNING, ERROR, ALL */
    '%' TYPE,               /* PROF -> DB parameters, ORA -> ORA errors, DBA -> Administration, DBO -> Operation */
    'DATE' SORT_BY          /* MESSAGE, DATE */
  FROM
    DUAL
)
SELECT
  TO_CHAR(TO_DATE(D.TIME, 'yyyymmddhh24miss'), 'dd.mm.yyyy hh24:mi:ss') MSG_DATE,
  D.PARAM NAME,
  DECODE(D.TYPE, 'DBA', 'BR0970', 'DBO', 'BR0973', 'ORA', 'BR0976', 
    'PROF', 'BR0978') || D.SEVERITY BRCONNECT_CODE,
  D.MSGDESC MSG_TEXT
FROM
  BASIS_INFO BI,
  DBMSGORA D
WHERE
  TO_DATE(D.TIME, 'yyyymmddhh24miss') BETWEEN
    BI.BEGIN_DATE AND BI.END_DATE AND
  D.PARAM LIKE BI.NAME_PATTERN AND
  D.MSGDESC LIKE BI.MSG_PATTERN AND
  ( BI.SEVERITY = 'ALL' OR
    BI.SEVERITY = '%' OR
    ( BI.SEVERITY = 'WARNING' AND D.SEVERITY = 'W' ) OR
    ( BI.SEVERITY = 'ERROR' AND D.SEVERITY = 'E' )
  ) AND
  ( D.TYPE LIKE BI.TYPE )
ORDER BY
  DECODE(BI.SORT_BY, 'DATE', D.TIME, ' ') DESC,
  D.MSGDESC
));