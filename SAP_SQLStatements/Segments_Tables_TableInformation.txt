SELECT NULL OWNER, NULL TABLE_NAME, NULL INDEXES, NULL COLUMNS, NULL "LONG", NULL "LOB",
NULL IOT, NULL PARTITIONS, NULL BLOCKS, NULL NUM_ROWS, NULL ROW_LEN
FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL INDEXES, NULL COLUMNS, NULL "LONG", NULL "LOB",
NULL IOT, NULL PARTITIONS, NULL BLOCKS, NULL NUM_ROWS, NULL ROW_LEN
FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT /*+ OPT_PARAM('OPTIMIZER_DYNAMIC_SAMPLING', 6) */
    'SAP%' OWNER,
    'RFBLG' TABLE_NAME
  FROM
    DUAL
),
INDEXES AS
( SELECT
    I.TABLE_OWNER,
    I.TABLE_NAME,
    COUNT(*) NUM_INDEXES
  FROM
    BASIS_INFO BI,
    DBA_INDEXES I
  WHERE
    I.TABLE_OWNER LIKE BI.OWNER AND
    I.TABLE_NAME LIKE BI.TABLE_NAME
  GROUP BY
    I.TABLE_OWNER,
    I.TABLE_NAME
)  
SELECT
  T.OWNER,
  T.TABLE_NAME,
  TO_CHAR(I.NUM_INDEXES, 999990) INDEXES,
  TO_CHAR(COUNT(DISTINCT(TC.COLUMN_NAME)), 999990) COLUMNS,
  TO_CHAR(SUM(DECODE(TC.DATA_TYPE, 'LONG', 1, 'LONG RAW', 1, 0)), 990) "LONG",
  TO_CHAR(SUM(DECODE(TC.DATA_TYPE, 'BLOB', 1, 'CLOB', 1, 'NCLOB', 1, 0)), 90) "LOB",
  DECODE(T.IOT_NAME, NULL, ' ', 'X') IOT,
  TO_CHAR(NVL(PT.PARTITION_COUNT, 0), 999999990) PARTITIONS,
  TO_CHAR(T.BLOCKS, 999999990) BLOCKS,
  TO_CHAR(T.NUM_ROWS, 9999999990) NUM_ROWS,
  TO_CHAR(T.AVG_ROW_LEN, 999990) ROW_LEN
FROM
  BASIS_INFO BI,
  DBA_TABLES T,
  DBA_TAB_COLUMNS TC,
  DBA_PART_TABLES PT,
  INDEXES I
WHERE
  T.OWNER LIKE BI.OWNER AND
  T.TABLE_NAME LIKE BI.TABLE_NAME AND
  T.OWNER = TC.OWNER AND
  T.TABLE_NAME = TC.TABLE_NAME AND
  T.OWNER = PT.OWNER (+) AND
  T.TABLE_NAME = PT.TABLE_NAME (+) AND
  T.OWNER = I.TABLE_OWNER (+) AND
  T.TABLE_NAME = I.TABLE_NAME (+)
GROUP BY
  T.OWNER,
  T.TABLE_NAME,
  T.IOT_NAME,
  T.BLOCKS,
  T.NUM_ROWS,
  T.AVG_ROW_LEN,
  I.NUM_INDEXES,
  NVL(PT.PARTITION_COUNT, 0)
));