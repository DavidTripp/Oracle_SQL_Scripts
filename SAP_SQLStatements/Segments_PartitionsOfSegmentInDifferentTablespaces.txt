SELECT NULL OWNER, NULL OBJECT_NAME, NULL OBJECT_TYPE,
  NULL TSP_EXAMPLE_1, NULL TSP_EXAMPLE_2, 
  NULL NUM_DIFF_TABLESPACES FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL OBJECT_NAME, NULL OBJECT_TYPE,
  NULL TSP_EXAMPLE_1, NULL TSP_EXAMPLE_2, 
  NULL NUM_DIFF_TABLESPACES FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER
  FROM
    DUAL
)
SELECT
  OWNER,
  OBJECT_NAME,
  OBJECT_TYPE,
  TSP_EXAMPLE_1,
  TSP_EXAMPLE_2,
  NUM_DIFF_TABLESPACES
FROM
( SELECT
    TP.TABLE_OWNER OWNER,
    TP.TABLE_NAME OBJECT_NAME,
    'TABLE' OBJECT_TYPE,
    MIN(TP.TABLESPACE_NAME) TSP_EXAMPLE_1,
    MAX(TP.TABLESPACE_NAME) TSP_EXAMPLE_2,
    TO_CHAR(COUNT(DISTINCT(TP.TABLESPACE_NAME)), 
      9999999999999999990) NUM_DIFF_TABLESPACES
  FROM
    BASIS_INFO BI,
    DBA_TAB_PARTITIONS TP
  WHERE
    TP.TABLE_OWNER LIKE BI.OWNER
  GROUP BY
    TP.TABLE_OWNER,
    TP.TABLE_NAME
  UNION ALL
  ( SELECT
      IP.INDEX_OWNER OWNER,
      IP.INDEX_NAME OBJECT_NAME,
      'INDEX' OBJECT_TYPE,
      MIN(IP.TABLESPACE_NAME) TSP_EXAMPLE_1,
      MAX(IP.TABLESPACE_NAME) TSP_EXAMPLE_2,
      TO_CHAR(COUNT(DISTINCT(IP.TABLESPACE_NAME)), 
        9999999999999999990) NUM_DIFF_TABLESPACES
    FROM
      BASIS_INFO BI,
      DBA_IND_PARTITIONS IP
    WHERE
      IP.INDEX_OWNER LIKE BI.OWNER 
    GROUP BY
      IP.INDEX_OWNER,
      IP.INDEX_NAME
  )
)
WHERE 
  NUM_DIFF_TABLESPACES > 1
ORDER BY
  OWNER, 
  OBJECT_NAME
));
