SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL STATS_UPDATE_TIME
  FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL STATS_UPDATE_TIME
  FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    'DRAW' TABLE_NAME,
    '%' PARTITION_NAME
  FROM
    DUAL
)
SELECT
  TSH.OWNER,
  TSH.TABLE_NAME,
  TSH.PARTITION_NAME,
  TO_CHAR(TSH.STATS_UPDATE_TIME, 'dd.mm.yyyy hh24:mi:ss') STATS_UPDATE_TIME
FROM
  BASIS_INFO BI,
  DBA_TAB_STATS_HISTORY TSH
WHERE
  TSH.OWNER LIKE BI.OWNER AND
  TSH.TABLE_NAME LIKE BI.TABLE_NAME AND
  ( TSH.PARTITION_NAME IS NULL OR TSH.PARTITION_NAME LIKE BI.PARTITION_NAME )
ORDER BY
  TSH.OWNER,
  TSH.TABLE_NAME,
  TSH.PARTITION_NAME,
  TSH.STATS_UPDATE_TIME DESC
));
