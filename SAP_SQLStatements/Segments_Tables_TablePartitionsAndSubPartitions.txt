SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL PART_ROWS, NULL PART_HIGH, 
  NULL SUBPART_NAME, NULL SUBPART_ROWS, NULL SUBPART_HIGH,
  NULL SIZE_MB, NULL "SIZE_%" FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL PART_ROWS, NULL PART_HIGH, 
  NULL SUBPART_NAME, NULL SUBPART_ROWS, NULL SUBPART_HIGH,
  NULL SIZE_MB, NULL "SIZE_%" FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    'ADRC' TABLE_NAME
  FROM
    DUAL
)
SELECT 
  DECODE(NVL(SUBPART_POS, 1), 1, OWNER, NULL) OWNER,
  DECODE(NVL(SUBPART_POS, 1), 1, TABLE_NAME, NULL) TABLE_NAME,
  DECODE(NVL(SUBPART_POS, 1), 1, PARTITION_NAME, NULL) PARTITION_NAME,
  DECODE(NVL(SUBPART_POS, 1), 1, TO_CHAR(PART_ROWS, 999999990), NULL) PART_ROWS,
  PART_HIGH,
  SUBPART_NAME,
  TO_CHAR(SUBPART_ROWS, 99999999990) SUBPART_ROWS,
  SUBPART_HIGH,
  TO_CHAR(BYTES / 1024 / 1024, 9999990.99) SIZE_MB,
  TO_CHAR(RATIO_TO_REPORT(BYTES) OVER (PARTITION BY OWNER, TABLE_NAME) * 100, 990.99) "SIZE_%"
FROM
( SELECT 
    DTP.TABLE_OWNER OWNER,
    DTP.TABLE_NAME TABLE_NAME,
    DTP.PARTITION_NAME PARTITION_NAME,
    DTP.PARTITION_POSITION PART_POSITION,
    DTP.NUM_ROWS PART_ROWS,
    DTP.HIGH_VALUE PART_HIGH,
    NULL SUBPART_NAME,
    NULL SUBPART_POS,
    NULL SUBPART_ROWS,
    NULL SUBPART_HIGH,
    NVL(DS.BYTES, 0) BYTES,
    O.CREATED
  FROM
    BASIS_INFO BI,
    DBA_TAB_PARTITIONS DTP,
    DBA_SEGMENTS DS,
    DBA_OBJECTS O
  WHERE
    DTP.TABLE_OWNER LIKE BI.OWNER AND
    DTP.TABLE_NAME LIKE BI.TABLE_NAME AND
    DTP.TABLE_OWNER = O.OWNER AND
    DTP.TABLE_NAME = O.OBJECT_NAME AND
    DTP.PARTITION_NAME = O.SUBOBJECT_NAME AND
    DS.SEGMENT_TYPE (+) = 'TABLE PARTITION' AND
    DS.OWNER (+) = O.OWNER AND
    DS.SEGMENT_NAME (+) = O.OBJECT_NAME AND
    DS.PARTITION_NAME (+) = O.SUBOBJECT_NAME
  UNION ALL
  ( SELECT 
      DTP.TABLE_OWNER OWNER,
      DTP.TABLE_NAME TABLE_NAME,
      DTP.PARTITION_NAME PARTITION_NAME,
      DTP.PARTITION_POSITION PART_POSITION,
      DTP.NUM_ROWS PART_ROWS,
      DTP.HIGH_VALUE PART_HIGH,
      DTS.SUBPARTITION_NAME SUBPART_NAME,
      DTS.SUBPARTITION_POSITION SUBPART_POS,
      DTS.NUM_ROWS SUBPART_ROWS,
      DTS.HIGH_VALUE SUBPART_HIGH,
      NVL(DS.BYTES, 0) BYTES,
      O.CREATED
    FROM
      BASIS_INFO BI,
      DBA_TAB_PARTITIONS DTP,
      DBA_TAB_SUBPARTITIONS DTS,
      DBA_SEGMENTS DS,
      DBA_OBJECTS O
    WHERE
      DTP.TABLE_OWNER LIKE BI.OWNER AND
      DTP.TABLE_NAME LIKE BI.TABLE_NAME AND
      DTP.TABLE_OWNER = DTS.TABLE_OWNER AND
      DTP.TABLE_NAME = DTS.TABLE_NAME AND
      DTP.PARTITION_NAME = DTS.PARTITION_NAME AND
      DTS.TABLE_OWNER = O.OWNER AND
      DTS.TABLE_NAME = O.OBJECT_NAME AND
      DTS.SUBPARTITION_NAME = O.SUBOBJECT_NAME AND
      DS.SEGMENT_TYPE (+) = 'TABLE SUBPARTITION' AND
      DS.OWNER (+) = O.OWNER AND
      DS.SEGMENT_NAME (+) = O.OBJECT_NAME AND
      DS.PARTITION_NAME (+) = O.SUBOBJECT_NAME
  )
) S
ORDER BY
  S.OWNER,
  S.TABLE_NAME,
  S.PART_POSITION,
  NVL(S.SUBPART_POS, 0)
));