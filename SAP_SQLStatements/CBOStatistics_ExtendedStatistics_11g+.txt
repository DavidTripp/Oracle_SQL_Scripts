SELECT NULL OWNER, NULL TABLE_NAME, NULL STAT_EXTENSION, NULL COLUMN_NAME, NULL NUM_DISTINCT, NULL AVG_COL_LEN,
  NULL BUCKETS FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL STAT_EXTENSION, NULL COLUMN_NAME, NULL NUM_DISTINCT, NULL AVG_COL_LEN,
  NULL BUCKETS FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT /*+ OPT_PARAM('OPTIMIZER_DYNAMIC_SAMPLING', 6) */
    'SAP%' OWNER,
    '%' TABLE_NAME
  FROM
    DUAL
)
SELECT
  SE.OWNER,
  SE.TABLE_NAME,
  SE.EXTENSION STAT_EXTENSION,
  TCS.COLUMN_NAME,
  TO_CHAR(TCS.NUM_DISTINCT, 99999999990) NUM_DISTINCT,
  TO_CHAR(TCS.AVG_COL_LEN, 9999999990) AVG_COL_LEN,
  TO_CHAR(TCS.NUM_BUCKETS, 999990) BUCKETS
FROM
  BASIS_INFO BI,
  DBA_STAT_EXTENSIONS SE,
  DBA_TAB_COLS TCS
WHERE
  SE.OWNER LIKE BI.OWNER AND
  SE.TABLE_NAME LIKE BI.TABLE_NAME AND
  SE.OWNER = TCS.OWNER (+) AND
  SE.TABLE_NAME = TCS.TABLE_NAME (+) AND
  SE.EXTENSION_NAME = TCS.COLUMN_NAME (+)
));

