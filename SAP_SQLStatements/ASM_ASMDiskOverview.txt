SELECT NULL DGNAME, NULL REDUNDANCY, NULL FILETYPE, NULL DISKNAME, NULL FAILGROUP,
NULL PREFERRED_READ FROM DUAL WHERE 1=0 
UNION ALL
(SELECT NULL DGNAME, NULL REDUNDANCY, NULL FILETYPE, NULL DISKNAME, NULL FAILGROUP,
NULL PREFERRED_READ FROM DUAL WHERE 1=0 )
UNION ALL
SELECT * FROM (
WITH BASIS_INFO AS
(
SELECT 
	'X' QUICK /*+ Use v$asm_disk_stat and v$asm_diskgroup_stat for quick access, but new disks will not be included */
FROM
	DUAL
),
ASMFILE AS
(
SELECT 
	GROUP_NUMBER,
	LISTAGG(TYPE||'('||NUM||')',',')
	WITHIN GROUP(ORDER BY TYPE) FILETYPE
FROM
(SELECT 
	GROUP_NUMBER, TYPE, COUNT (*) NUM
FROM
	V$ASM_FILE
GROUP BY 
	GROUP_NUMBER, TYPE)
GROUP BY
	GROUP_NUMBER
)
SELECT
	DGNAME,
	DECODE(REDUNDANCY,'EXTERN',REDUNDANCY||'(X1)',
					'NORMAL',REDUNDANCY||'(X2)',
					'HIGH',REDUNDANCY||'(X3)') REDUNDANCY,
	FILETYPE,
	DISKNAME,
	FAILGROUP,
	PREFERRED_READ
	FROM
	(
	(
		SELECT
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', ADG.NAME) DGNAME,
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', ADG.TYPE) REDUNDANCY,
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', AF.FILETYPE) FILETYPE,
			AD.NAME DISKNAME,
			AD.FAILGROUP,
			AD.PREFERRED_READ
		FROM
			V$ASM_DISK_STAT AD,
			V$ASM_DISKGROUP_STAT ADG,
			ASMFILE AF,
			BASIS_INFO BI
		WHERE
			AD.GROUP_NUMBER = ADG.GROUP_NUMBER AND
			AF.GROUP_NUMBER = AD.GROUP_NUMBER AND
			BI.QUICK = 'X'
	)
	UNION ALL
		SELECT
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', ADG.NAME) DGNAME,
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', ADG.TYPE) REDUNDANCY,
			DECODE(LAG(ADG.NAME,1) OVER (ORDER BY ADG.NAME, ADG.TYPE, AF.FILETYPE, AD.NAME), ADG.NAME, ' ', AF.FILETYPE) FILETYPE,
			AD.NAME DISKNAME,
			AD.FAILGROUP,
			AD.PREFERRED_READ
		FROM
			V$ASM_DISK AD,
			V$ASM_DISKGROUP ADG,
			ASMFILE AF,
			BASIS_INFO BI
		WHERE
			AD.GROUP_NUMBER = ADG.GROUP_NUMBER AND
			AF.GROUP_NUMBER = AD.GROUP_NUMBER AND
			BI.QUICK IS NULL
	)
);
