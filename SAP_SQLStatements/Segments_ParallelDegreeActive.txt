SELECT NULL OWNER, NULL SEGMENT_NAME, NULL RESET_COMMAND, NULL SEGMENT_TYPE, 
  NULL DEGREE, NULL INSTANCES FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL SEGMENT_NAME, NULL RESET_COMMAND, NULL SEGMENT_TYPE, 
  NULL DEGREE, NULL INSTANCES FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    'ALL' SEGMENT_TYPE     /* ALL, INDEX, TABLE */
  FROM
    DUAL
)
SELECT
  OWNER,
  SEGMENT_NAME,
  'ALTER ' || SEGMENT_TYPE || ' "' || 
    SEGMENT_NAME || '" NOPARALLEL;' RESET_COMMAND,
  SEGMENT_TYPE,
  LPAD(DEGREE, 10) DEGREE,
  LPAD(INSTANCES, 10) INSTANCES
FROM
( SELECT
    T.OWNER,
    T.TABLE_NAME SEGMENT_NAME,
    'TABLE' SEGMENT_TYPE,
    LTRIM(T.DEGREE) DEGREE,
    LTRIM(T.INSTANCES) INSTANCES
  FROM 
    BASIS_INFO BI,
    DBA_TABLES T
  WHERE
    T.OWNER LIKE BI.OWNER AND
    BI.SEGMENT_TYPE IN ('ALL', 'TABLE') AND
    ( LTRIM(T.DEGREE) != '1' OR 
      LTRIM(T.INSTANCES) NOT IN ( '0', '1' )
    )
  UNION ALL
  ( SELECT
      I.OWNER,
      I.INDEX_NAME SEGMENT_NAME,
      'INDEX' SEGMENT_TYPE,
      I.DEGREE,
      I.INSTANCES
    FROM 
      BASIS_INFO BI,
      DBA_INDEXES I
    WHERE
      I.OWNER LIKE BI.OWNER AND
      BI.SEGMENT_TYPE IN ('ALL', 'INDEX') AND
      I.INDEX_TYPE != 'LOB' AND
      ( LTRIM(I.DEGREE) != '1' OR 
        LTRIM(I.INSTANCES) NOT IN ( '0', '1' )
      )
  )
)
ORDER BY
  SEGMENT_TYPE,
  OWNER,
  SEGMENT_NAME
));