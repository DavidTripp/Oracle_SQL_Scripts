SELECT NULL SID, NULL INST, NULL SQL_ID, NULL ROLE, NULL ACTION, NULL SQL_TEXT FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL SID, NULL INST, NULL SQL_ID, NULL ROLE, NULL ACTION, NULL SQL_TEXT FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    '%' SQL_ID
  FROM
    DUAL
)
SELECT
  TO_CHAR(PS.SID, 99990) SID,
  TO_CHAR(PS.INST_ID, 990) INST,
  S.SQL_ID,
  DECODE(SERVER_SET, NULL, 'COORDINATOR', 1, '  CONSUMER', '    PRODUCER') ROLE,
  DECODE(S.WAIT_TIME, 0, S.EVENT, 'CPU') ACTION,
  NVL(SQ.SQL_TEXT, AA.NAME) SQL_TEXT
FROM 
  BASIS_INFO BI,
  GV$PX_SESSION PS,
  GV$SESSION S,
  GV$SQL SQ,
  AUDIT_ACTIONS AA
WHERE
  S.SQL_ID LIKE BI.SQL_ID AND
  S.SID = PS.SID AND
  S.INST_ID = PS.INST_ID AND
  S.INST_ID = SQ.INST_ID (+) AND
  S.SQL_ID = SQ.SQL_ID (+) AND
  S.SQL_CHILD_NUMBER = SQ.CHILD_NUMBER (+) AND
  AA.ACTION = S.COMMAND
ORDER BY 
  PS.QCSID, 
  NVL(PS.SERVER_SET, 0),
  NVL(PS.SERVER#, 0)
));
