SELECT NULL ACTION, NULL ID, NULL CBO_COSTS, NULL CBO_ROWS, NULL REAL_ROWS,
  NULL ROWS_PER_START, NULL BUFFER_GETS, NULL BG_PER_START, NULL DISK_READS,
  NULL TIME, NULL STARTS, NULL AP, NULL FP FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL ACTION, NULL ID, NULL CBO_COSTS, NULL CBO_ROWS, NULL REAL_ROWS,
  NULL ROWS_PER_START, NULL BUFFER_GETS, NULL BG_PER_START, NULL DISK_READS,
  NULL TIME, NULL STARTS, NULL AP, NULL FP FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'ay5m7npsctaww' SQL_ID,
    'X' INCLUDE_PREDICATES
  FROM
    DUAL
)
SELECT
  'SQL_ID: ' || SQL_ID ACTION,
  NULL ID,
  NULL CBO_COSTS,
  NULL CBO_ROWS,
  NULL REAL_ROWS,
  NULL ROWS_PER_START,
  NULL BUFFER_GETS,
  NULL BG_PER_START,
  NULL DISK_READS,
  NULL TIME,
  NULL STARTS, 
  NULL AP,
  NULL FP
FROM
  BASIS_INFO
UNION ALL
( SELECT
    NULL ACTION,
    NULL ID,
    NULL CBO_COSTS,
    NULL CBO_ROWS,
    NULL REAL_ROWS,
    NULL ROWS_PER_START,
    NULL BUFFER_GETS,
    NULL BG_PER_START,
    NULL DISK_READS,
    NULL TIME,
    NULL STARTS, 
    NULL AP,
    NULL FP
  FROM
    DUAL
)
UNION ALL
( SELECT
    ACTION,
    ID,
    CBO_COSTS,
    CBO_ROWS,
    REAL_ROWS,
    ROWS_PER_START,
    BUFFER_GETS,
    BG_PER_START,
    DISK_READS,
    TIME,
    STARTS,
    ACCESS_PREDICATES AP,
    FILTER_PREDICATES FP
  FROM
  ( SELECT 
      LPAD(' ', PS.DEPTH) || OPERATION || ' ' || 
        OPTIONS || DECODE(OBJECT_NAME, NULL, NULL, ' (' || 
        OBJECT_NAME || ')') ACTION,
      TO_CHAR(PS.ID, 990) ID,
      TO_CHAR(PS.COST, 99999990) CBO_COSTS,
      TO_CHAR(PS.CARDINALITY, 999999990) CBO_ROWS,
      TO_CHAR(PS.LAST_OUTPUT_ROWS, 999999990) REAL_ROWS,
      TO_CHAR(DECODE(PS.LAST_STARTS, 0, 0, ROUND(PS.LAST_OUTPUT_ROWS / PS.LAST_STARTS, 2)), 9999999990.99) ROWS_PER_START,
      TO_CHAR(PS.LAST_CR_BUFFER_GETS + PS.LAST_CU_BUFFER_GETS, 9999999990) BUFFER_GETS,
      TO_CHAR(DECODE(PS.LAST_STARTS, 0, 0, ROUND((PS.LAST_CR_BUFFER_GETS + PS.LAST_CU_BUFFER_GETS) / 
        PS.LAST_STARTS, 2)), 99999990.99) BG_PER_START,
      TO_CHAR(PS.LAST_DISK_READS, 999999990) DISK_READS,
      TO_CHAR(PS.LAST_ELAPSED_TIME, 9999999990) TIME,
      TO_CHAR(PS.LAST_STARTS, 9999990) STARTS,
      DECODE(BI.INCLUDE_PREDICATES, 'X', PS.ACCESS_PREDICATES, ' ') ACCESS_PREDICATES,
      DECODE(BI.INCLUDE_PREDICATES, 'X', PS.FILTER_PREDICATES, ' ') FILTER_PREDICATES
    FROM 
      BASIS_INFO BI,
      V$SQL_PLAN_STATISTICS_ALL PS
    WHERE
      PS.SQL_ID = BI.SQL_ID
    ORDER BY 
      PS.CHILD_NUMBER,
      PS.ID
  )
)
));
