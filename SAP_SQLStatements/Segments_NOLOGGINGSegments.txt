SELECT NULL OWNER, NULL SEGMENT_NAME, NULL SEGMENT_TYPE, NULL COMMAND FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL SEGMENT_NAME, NULL SEGMENT_TYPE, NULL COMMAND FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    '%' SEGMENT_TYPE,          /* INDEX, TABLE, LOB, % */
    'X' EXCLUDE_TEMP_TABLES,
    'X' EXCLUDE_BW_INTERMEDIATE_TABLES
  FROM
    DUAL
)
SELECT
  OWNER,
  SEGMENT_NAME,
  SEGMENT_TYPE,
  COMMAND
FROM
( SELECT
    I.OWNER,
    I.INDEX_NAME SEGMENT_NAME,
    'INDEX' SEGMENT_TYPE,
    'ALTER INDEX "' || I.OWNER || '"."' || I.INDEX_NAME || '" LOGGING;' COMMAND
  FROM
    BASIS_INFO BI,
    DBA_INDEXES I
  WHERE
    I.OWNER LIKE BI.OWNER AND
    I.LOGGING = 'NO' AND
    I.INDEX_TYPE != 'LOB' AND
    'INDEX' LIKE BI.SEGMENT_TYPE
  UNION ALL
  ( SELECT
      T.OWNER,
      T.TABLE_NAME SEGMENT_NAME,
      'TABLE' SEGMENT_TYPE,
      'ALTER TABLE "' || T.OWNER || '"."' || T.TABLE_NAME || '" LOGGING;' COMMAND
    FROM
      BASIS_INFO BI,
      DBA_TABLES T
    WHERE
      T.OWNER LIKE BI.OWNER AND
      T.LOGGING = 'NO' AND
      'TABLE' LIKE BI.SEGMENT_TYPE AND
      ( BI.EXCLUDE_BW_INTERMEDIATE_TABLES = ' ' OR T.TABLE_NAME NOT LIKE '/BI_/06%' ) AND
      ( BI.EXCLUDE_TEMP_TABLES = ' ' OR T.TEMPORARY = 'N' )
  )  
  UNION ALL
  ( SELECT
      L.OWNER,
      L.TABLE_NAME || '.' || L.COLUMN_NAME SEGMENT_NAME,
      'LOB' SEGMENT_TYPE,
      'ALTER TABLE "' || L.OWNER || '"."' || L.TABLE_NAME || '" MODIFY LOB ("' || L.COLUMN_NAME || '") (' || 
        DECODE(L.CACHE, 'YES', 'CACHE', 'NOCACHE') || ' LOGGING);' COMMAND
    FROM
     BASIS_INFO BI,
     DBA_LOBS L
    WHERE
      L.OWNER LIKE BI.OWNER AND
      L.LOGGING = 'NO' AND
      'LOB' LIKE BI.SEGMENT_TYPE
  )
)
ORDER BY
  OWNER,
  SEGMENT_TYPE DESC,
  SEGMENT_NAME
));
