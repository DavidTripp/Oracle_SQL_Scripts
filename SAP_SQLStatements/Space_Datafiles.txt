SELECT NULL "TABLESPACE", NULL FILE_ID, NULL SIZE_GB, NULL CREATION_TIME,
  NULL FILE_NAME FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL "TABLESPACE", NULL FILE_ID, NULL SIZE_GB, NULL CREATION_TIME,
  NULL FILE_NAME FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'PSAPUNDO' TABLESPACE_NAME,
    'CREATION_TIME' ORDER_BY   /* TABLESPACE, NAME, ID, CREATION_TIME */
  FROM
    DUAL
)
SELECT
  TABLESPACE_NAME "TABLESPACE",
  TO_CHAR(FILE_ID, 999990) FILE_ID,
  TO_CHAR(BYTES / 1024 / 1024 / 1024, 990.99) SIZE_GB,
  TO_CHAR(CREATION_TIME, 'dd.mm.yyyy hh24:mi:ss') CREATION_TIME,
  FILE_NAME
FROM
( SELECT
    DF.TABLESPACE_NAME,
    DF.FILE_ID,
    DF.BYTES,
    VD.CREATION_TIME,
    DF.FILE_NAME,
    BI.ORDER_BY
  FROM
    BASIS_INFO BI,
    DBA_DATA_FILES DF,
    V$DATAFILE VD
  WHERE
    DF.TABLESPACE_NAME LIKE BI.TABLESPACE_NAME AND
    DF.FILE_ID = VD.FILE#
  UNION ALL
  ( SELECT
      TF.TABLESPACE_NAME,
      TF.FILE_ID,
      TF.BYTES,
      VT.CREATION_TIME,
      TF.FILE_NAME,
      BI.ORDER_BY
    FROM
      BASIS_INFO BI,
      DBA_TEMP_FILES TF,
      V$DATAFILE VT
    WHERE
      TF.TABLESPACE_NAME LIKE BI.TABLESPACE_NAME AND
      TF.FILE_ID = VT.FILE#
  )
)
ORDER BY
  DECODE(ORDER_BY, 'TABLESPACE', TABLESPACE_NAME, ' '),
  DECODE(ORDER_BY, 'FILE', FILE_NAME, ' '),
  DECODE(ORDER_BY, 'CREATION_TIME', CREATION_TIME) DESC,
  FILE_ID
));
